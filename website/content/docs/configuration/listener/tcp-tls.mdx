---
layout: docs
page_title: TCP TLS - Listeners - Configuration
description: |-
  Configure the TCP listener with TLS to encrypt
  traffic in-transit from Vault Clients to your Vault cluster.
---

# Configure TLS for TCP listener

Encryption of data in transit using TLS is an important part of a secure Vault
deployment.

This guide provides a basic Vault TLS configuration in alignment with client support
needs, modern cryptography standards, and environment-specific security
requirements.

## Background

Vault enables TLS for inbound TCP connections with a reasonably secure set of
defaults, inherited from those provided by the [Go crypto/tls
package](https://pkg.go.dev/crypto/tls). The Go team has developed an
[opinionated approach to TLS
configuration](https://go.dev/blog/tls-cipher-suites) and particularly
ciphersuite selection, which Vault inherits through use of this package.

## Requirements

- A valid TLS certificate file, secret key, and (if required) CA file.

## Default Vault TLS configuration

A default Vault [TCP
listener](/vault/docs/configuration/listener/tcp)
configuration accepts TLS 1.2 or 1.3 connections. Attempts to connect using
TLS 1.0 and 1.1 are dropped.

The ciphersuites used for **TLS 1.2** depends on whether Vault has been
configured with a RSA or ECDSA certificate. The TLS configuration may include
any ciphers supported by Go’s TLS package and Vault’s [ciphersuite configuration
parser](https://github.com/hashicorp/go-secure-stdlib/blob/main/tlsutil/tlsutil.go#L31-L57).

<Highlight title="Go TLS configuration">

While the Go team believes this set of ciphers are appropriate for modern secure
usage, and HashiCorp agrees, some vulnerability scanners may flag issues with
this configuration.

In particular, Sweet32 (CVE-2016-2183) is an attack against 64-bit block size
ciphers including 3DES that may allow an attacker to break the encryption of
long lived connections.

The Go team did not believe this attack was sufficient to remove existing client
compatibility by deprecating 3DES support (per the researcher’s [vulnerability
disclosure](https://sweet32.info/) it took a single HTTPS session with 785 GB of
traffic to break the
encryption). Go did [deprioritize 3DES](https://github.com/golang/go/issues/45430) in
favor of AES-based ciphers.

</Highlight>

The ciphersuites used for **TLS 1.3** are `TLS_AES_128_GCM_SHA256`,
`TLS_AES_256_GCM_SHA384`, and `TLS_CHACHA20_POLY1305_SHA256`.

## Configure TLS for a Vault TCP listener

To run Vault with the default TLS configuration, add the TLS certificate to the
Vault configuration files `listener` stanza and start Vault.

<Note>

If the TLS configuration is added after your Vault cluster is running, you must
restart the cluster gracefully. A sighup will not reload the TLS configuration.

Refer to the [HashiCorp support knowledge
base](https://support.hashicorp.com/hc/en-us/articles/17169701076371-A-Step-by-Step-Guide-to-Restarting-a-Vault-Cluster)
for more information.

</Note>

**Example configuration:**

<CodeBlockConfig hideClipboard>

```plaintext
listener "tcp" {
  address = "127.0.0.1:8200"
  tls_cert_file = "cert.pem"
  tls_key_file  = "key.pem"
}
```

</CodeBlockConfig>

You can verify the TLS configuration using an SSL scanner such as
[`sslscan`](https://github.com/rbsec/sslscan) or similar tools.

**Example sslscan output:**

<Tabs>
<Tab heading="ECDSA certificate">

<CodeBlockConfig hideClipboard>

```shell-session
$ sslscan 127.0.0.1:8200
Version: 2.1.3
OpenSSL 3.2.1 30 Jan 2024

Connected to 127.0.0.1

Testing SSL server 127.0.0.1 on port 8200 using SNI name 127.0.0.1

  SSL/TLS Protocols:
SSLv2     disabled
SSLv3     disabled
TLSv1.0   disabled
TLSv1.1   disabled
TLSv1.2   enabled
TLSv1.3   enabled

  TLS Fallback SCSV:
Server supports TLS Fallback SCSV

  TLS renegotiation:
Session renegotiation not supported

  TLS Compression:
Compression disabled

  Heartbleed:
TLSv1.3 not vulnerable to heartbleed
TLSv1.2 not vulnerable to heartbleed

  Supported Server Cipher(s):
Preferred TLSv1.3  128 bits  TLS_AES_128_GCM_SHA256        Curve 25519 DHE 253
Accepted  TLSv1.3  256 bits  TLS_AES_256_GCM_SHA384        Curve 25519 DHE 253
Accepted  TLSv1.3  256 bits  TLS_CHACHA20_POLY1305_SHA256  Curve 25519 DHE 253
Preferred TLSv1.2  128 bits  ECDHE-ECDSA-AES128-GCM-SHA256 Curve 25519 DHE 253
Accepted  TLSv1.2  256 bits  ECDHE-ECDSA-AES256-GCM-SHA384 Curve 25519 DHE 253
Accepted  TLSv1.2  256 bits  ECDHE-ECDSA-CHACHA20-POLY1305 Curve 25519 DHE 253
Accepted  TLSv1.2  128 bits  ECDHE-ECDSA-AES128-SHA        Curve 25519 DHE 253
Accepted  TLSv1.2  256 bits  ECDHE-ECDSA-AES256-SHA        Curve 25519 DHE 253

  Server Key Exchange Group(s):
TLSv1.3  128 bits  secp256r1 (NIST P-256)
TLSv1.3  192 bits  secp384r1 (NIST P-384)
TLSv1.3  260 bits  secp521r1 (NIST P-521)
TLSv1.3  128 bits  x25519
TLSv1.2  128 bits  secp256r1 (NIST P-256)
TLSv1.2  192 bits  secp384r1 (NIST P-384)
TLSv1.2  260 bits  secp521r1 (NIST P-521)
TLSv1.2  128 bits  x25519

  SSL Certificate:
Signature Algorithm: ecdsa-with-SHA256
ECC Curve Name:      prime256v1
ECC Key Strength:    128

Subject:  localhost
Issuer:   localhost

Not valid before: May 17 17:27:29 2024 GMT
Not valid after:  Jun 16 17:27:29 2024 GMT
```

</CodeBlockConfig>

</Tab>
<Tab heading="RSA certificate">

<CodeBlockConfig hideClipboard>

```shell-session
sslscan 127.0.0.1:8200
Testing SSL server 127.0.0.1 on port 8200 using SNI name 127.0.0.1

  SSL/TLS Protocols:
SSLv2     disabled
SSLv3     disabled
TLSv1.0   disabled
TLSv1.1   disabled
TLSv1.2   enabled
TLSv1.3   enabled

  Supported Server Cipher(s):
Preferred TLSv1.3  128 bits  TLS_AES_128_GCM_SHA256        Curve 25519 DHE 253
Accepted  TLSv1.3  256 bits  TLS_AES_256_GCM_SHA384        Curve 25519 DHE 253
Accepted  TLSv1.3  256 bits  TLS_CHACHA20_POLY1305_SHA256  Curve 25519 DHE 253
Preferred TLSv1.2  128 bits  ECDHE-RSA-AES128-GCM-SHA256   Curve 25519 DHE 253
Accepted  TLSv1.2  256 bits  ECDHE-RSA-AES256-GCM-SHA384   Curve 25519 DHE 253
Accepted  TLSv1.2  256 bits  ECDHE-RSA-CHACHA20-POLY1305   Curve 25519 DHE 253
Accepted  TLSv1.2  128 bits  ECDHE-RSA-AES128-SHA          Curve 25519 DHE 253
Accepted  TLSv1.2  256 bits  ECDHE-RSA-AES256-SHA          Curve 25519 DHE 253
Accepted  TLSv1.2  128 bits  AES128-GCM-SHA256
Accepted  TLSv1.2  256 bits  AES256-GCM-SHA384
Accepted  TLSv1.2  128 bits  AES128-SHA
Accepted  TLSv1.2  256 bits  AES256-SHA
Accepted  TLSv1.2  112 bits  TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA
Accepted  TLSv1.2  112 bits  TLS_RSA_WITH_3DES_EDE_CBC_SHA

  Server Key Exchange Group(s):
TLSv1.3  128 bits  secp256r1 (NIST P-256)
TLSv1.3  192 bits  secp384r1 (NIST P-384)
TLSv1.3  260 bits  secp521r1 (NIST P-521)
TLSv1.3  128 bits  x25519
TLSv1.2  128 bits  secp256r1 (NIST P-256)
TLSv1.2  192 bits  secp384r1 (NIST P-384)
TLSv1.2  260 bits  secp521r1 (NIST P-521)
TLSv1.2  128 bits  x25519

  SSL Certificate:
Signature Algorithm: sha256WithRSAEncryption
RSA Key Strength:    4096
```

</CodeBlockConfig>

</Tab>
</Tabs>

## Customize Vault TLS configuration

If this default TLS protocol and ciphersuite support is not suitable, Vault’s
TLS configuration can be customized using various parameters within the
[listener](/vault/docs/configuration/listener/tcp) configuration stanza.

### Configure TLS 1.2

If you require TLS 1.2, but with a non-default set of ciphersuites, you can
explicitly define the ciphersuites.

Add the `tls_min_version`, `tls_max_version`, and `tls_ciper_suites` parameters
to the `listner` stanza.

**Example configuration:**

<CodeBlockConfig hideClipboard highlight="5-7">

```plaintext
listener "tcp" {
  address = "127.0.0.1:8200"
  tls_cert_file = "cert.pem"
  tls_key_file  = "key.pem"
  tls_min_version = "tls12"
  tls_max_version = "tls12"
  tls_cipher_suites = "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256"}
```

</CodeBlockConfig>

Both `tls_min_version` and `tls_max_version` are set to `tls12` to disable usage
of TLS 1.3, as suggested in the [tcp listener
documentation](/vault/docs/configuration/listener/tcp#tls_cipher_suites).

The ciphersuites used in `tls_cipher_suites` are taken from the list supported by
Vault’s ciphersuite configuration parser. The ordering of `tls_cipher_suites` does
not matter, as Go will determine the ordering.

This configuration excludes any 3DES ciphers to avoid potential exposure to the
Sweet32 attack (CVE-2016-2183) described earlier. You can customize this example
to meet environment-specific security requirements.

### Configure TLS 1.3

If a reasonably modern set of clients are connecting to a Vault instance, you
can be configure the tcp listener stanza to accept just TLS 1.3.

Set the `tls_min_version` parameter to `tls13`.

**Example configuration:**

<CodeBlockConfig hideClipboard highlight="5">

```plaintext
listener "tcp" {
  address = "127.0.0.1:8200"
  tls_cert_file = "cert.pem"
  tls_key_file  = "key.pem"
  tls_min_version = "tls13"
}
```

</CodeBlockConfig>

Ciphersuite configuration is not supported in this mode. A select set of ciphers
has been selected by the Go team and aligned with the [modern
configuration](https://wiki.mozilla.org/Security/Server_Side_TLS#Modern_compatibility)
in the broadly-accepted Mozilla Security/Server Side TLS guidance.

## Next steps

- [Vault security model](/vault/docs/internals/security)
- [Vault production hardening tutorial](/vault/tutorials/operations/production-hardening)
- [Vault with integrated storage reference architecture](/vault/tutorials/day-one-raft/raft-reference-architecture)